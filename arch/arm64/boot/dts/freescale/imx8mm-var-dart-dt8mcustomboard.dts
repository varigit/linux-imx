// SPDX-License-Identifier: (GPL-2.0+ OR MIT)
/*
 * Copyright 2019 NXP
 * Copyright 2019-2021 Variscite Ltd.
 */

#include "imx8mm-var-dart.dtsi"
#include "imx8mm-var-dart-dt8mcustomboard-common.dtsi"

/ {
	model = "Variscite DART-MX8M-MINI on DT8MCustomBoard 2.x";

	gpio-keys {
		up {
			gpios = <&pca6408_1 5 GPIO_ACTIVE_LOW>;
		};

		down {
			gpios = <&pca6408_1 6 GPIO_ACTIVE_LOW>;
		};

		home {
			gpios = <&pca6408_1 4 GPIO_ACTIVE_LOW>;
		};

		back {
			gpios = <&pca6408_1 7 GPIO_ACTIVE_LOW>;
		};
	};

	leds {
		emmc {
			gpios = <&gpio4 18 GPIO_ACTIVE_HIGH>;
		};
	};

	extcon_usb1: extcon_usb1 {
		compatible = "linux,extcon-usb-gpio";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_extcon>;
		id-gpio = <&gpio1 10 GPIO_ACTIVE_HIGH>;
		status = "okay";
	};

	can0_osc: can0_osc {
		clock-frequency = <40000000>;
	};
};

&can0 {
	spi-max-frequency = <20000000>;
	microchip,rx-int-gpios = <&gpio5 4 GPIO_ACTIVE_LOW>;
};

&ft5x06_ts {
	reset-gpios = <&pca6408_2 4 GPIO_ACTIVE_LOW>;
};

&ov5640_mipi1 {
	pwn-gpios = <&pca6408_1 3 GPIO_ACTIVE_HIGH>;
	rst-gpios = <&pca6408_1 1 GPIO_ACTIVE_LOW>;
};

&i2c4 {
	pca6408_1: gpio@20 {
		compatible = "ti,tca6408";
		reg = <0x20>;
		gpio-controller;
		#gpio-cells = <2>;
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_pca6408>;
		interrupt-parent = <&gpio1>;
		interrupts = <5 IRQ_TYPE_EDGE_FALLING>;
	};

	pca6408_2: gpio@21 {
		compatible = "ti,tca6408";
		reg = <0x21>;
		gpio-controller;
		#gpio-cells = <2>;
	};
};

&pcie0 {
	reset-gpio = <&pca6408_2 3 GPIO_ACTIVE_LOW>;
};

&usbotg1 {
	extcon = <&extcon_usb1>;
};

&iomuxc {
	pinctrl_can: cangrp {
		fsl,pins = <
			MX8MM_IOMUXC_GPIO1_IO06_GPIO1_IO6		0x16
			MX8MM_IOMUXC_SPDIF_RX_GPIO5_IO4			0x16
		>;
	};

	pinctrl_captouch: captouchgrp {
		fsl,pins = <
			MX8MM_IOMUXC_GPIO1_IO14_GPIO1_IO14		0x16
		>;
	};

	pinctrl_leds: ledgrp {
		fsl,pins = <
			MX8MM_IOMUXC_SAI1_TXD6_GPIO4_IO18		0x1c6
		>;
	};

	pinctrl_extcon: extcongrp {
		fsl,pins = <
			MX8MM_IOMUXC_GPIO1_IO10_GPIO1_IO10		0x19
		>;
	};

	pinctrl_pca6408: pca6408grp {
		fsl,pins = <
			MX8MM_IOMUXC_GPIO1_IO05_GPIO1_IO5		0x1c6
		>;
	};
};
